#!/bin/sh

if [ "$1" = "deploy" ] 
then
  shift
  if [ -z "$1" ]
    then
      notification_string="Deploying default branch"
      echo $notification_string
      echo "{\"text\" : \"$notification_string\"}" | curl -d @- https://projectkwl.slack.com/services/hooks/incoming-webhook?token=sSyagFIJbA8fGu38aDZXd0zn
      bundle exec cap staging deploy
    else
      notification_string="Deploying $1 branch"
      echo $notification_string
      echo "{\"text\" : \"$notification_string\"}" | curl -d @- https://projectkwl.slack.com/services/hooks/incoming-webhook?token=sSyagFIJbA8fGu38aDZXd0zn
      bundle exec cap staging deploy branch=$1
  fi
else 
  echo "Usage: please deploy BRANCH" 1>&2
  exit 1
fi
